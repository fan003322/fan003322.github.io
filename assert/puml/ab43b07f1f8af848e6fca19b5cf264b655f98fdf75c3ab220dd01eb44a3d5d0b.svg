<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="228px" preserveAspectRatio="none" style="width:794px;height:228px;background:#000000;" version="1.1" viewBox="0 0 794 228" width="794px" zoomAndPan="magnify"><defs/><g><rect fill="#1F1926" height="1" style="stroke:#1F1926;stroke-width:1.0;" width="1" x="0" y="0"/><rect fill="#EAE2C9" height="92" style="stroke:#EAE2C9;stroke-width:1.0;" width="792" x="0" y="0"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="321" x="10" y="26.4014">Add your own dedication into PlantUML</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4" x="10" y="42.6982"> </text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="160" x="10" y="58.9951">For just $5 per month!</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="10" y="75.292">Details on</text><a href="https://plantuml.com/dedication" target="" title="https://plantuml.com/dedication" xlink:actuate="onRequest" xlink:href="https://plantuml.com/dedication" xlink:show="new" xlink:title="https://plantuml.com/dedication" xlink:type="simple"><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="228" x="86" y="75.292">https://plantuml.com/dedication</text></a><image height="93" width="93" x="341" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAF0AAABdCAYAAADHcWrDAAADrUlEQVR4Xu2QMZIcMQwD9/8/8zcc3ifsdAaFLhIjzWkDBp1AIEjh8/P3z7/hd/moMLzPlH6AKf0AU/oBpvQDTOkHmNIPMKUfoFX65/PZju5w/KZ/F7rDMaVvRnc4pvTN6A5HXLq+JXRy9BM7/KmekuZM6UZPSXOmdKOnpDlLpetHHeTXHZWH9NTT8V91gvy6wzGlG/9VJ8ivOxxTuvFfdYL8usPxFaV39A56t8tJdYL8utsxpRc6QX7d7ZjSC50gv+52fHXpHQ/pHU9HJ8ivux1TeqET5Nfdjim90Any627HUukpnRz9XOWnWX1zpH4izZnSAz+R5kzpgZ9Ic+LSd0H5p/RdXPOJKX0z13xiSt/MNZ9olf6bdD5AHi3AoVknmNIPMKUfoFW6Hp58QGccqZ/Q3U/R3O35Kjh0eXKEzjhSP6G7n6K52/NVcOjy5AidcaR+Qnc/RXO356tQoYdU6HyVs8tD6B1PczqZxJT+MKeTSUzpD3M6mUSrdF3ilnV0gvx6h/N00HmXo2+VR3c4DzGlP/ToDuchpvSHHt3hPERcur45zy4/6QT5dcdTdJ/L1zfHlB6g+1y+vjmm9ADd5/L1zdEq/TZgjlE6fs2t/J1ZgmY113k6pLNTukHnK9LZKd2g8xXpbKt0CtVjKzqzqYfQmWq241nx32ZVcNAC/VBFZzb1EDpTzXY8K/7brAoOWqAfqujMph5CZ6rZjmfFf5tVwUEL9ENvejrofIXOO8ivWc5DTOkF5Ncs5yGm9ALya5bzEEulE3qIm+3oHU9HT6GcVCemdAPlpDoxpRsoJ9WJV0onOjlXD/n1zZH6CcrRuxOm9ALK0bsTpvQCytG7E1qlv41+tELnK9JZ8pOeMqUbyE96ypRuID/pKa3S9dM7oHzSOx69u/J0dPKQX98cU3qhk4f8+uaY0gudPOTXN0dcur4lUI5+LiHN0ZscqT9lSjek/pQp3ZD6U5ZK1w85yK87nnq+Ab2vYkrfgN5XMaVvQO+r+LrSic6s7n4KZZJOHmJKN1Am6eQhpnQDZZJOHuKrS3/DTx7SOx7SiSm90Dse0okpvdA7HtKJpdJTKGeXTp4VNNcR+1VwpKEE5ezSybOC5jpivwqONJSgnF06eVbQXEfsV8Ghh+yA8ld0Qnc7dMbN6lviuflVcOiBO6D8FZ3Q3Q6dcbP6lnhufhUceuAOKH9FJ3S3Q2fcrL4lnptfheF9pvQDTOkHmNIPMKUfYEo/wJR+gCn9AFP6Af4DOuloGRsspT8AAAAASUVORK5CYII=" y="0"/><rect fill="#000000" height="134.75" style="stroke:#000000;stroke-width:1.0;" width="792" x="0" y="92"/><text fill="#33FF02" font-family="sans-serif" font-size="12" font-style="italic" font-weight="bold" lengthAdjust="spacing" textLength="167" x="5" y="109">PlantUML 1.2022.4beta2</text><rect fill="#33FF02" height="21.2969" style="stroke:#33FF02;stroke-width:1.0;" width="177" x="5" y="118.9688"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="175" x="6" y="133.9688">[From string (line 3) ]</text><text fill="#33FF02" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="5" x="5" y="154.2656"> </text><text fill="#33FF02" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="131" x="5" y="170.5625">@startmindmap</text><text fill="#33FF02" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="122" x="5" y="186.8594">++ Page Faults</text><text fill="#33FF02" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" text-decoration="wavy underline" textLength="782" x="5" y="203.1563">+++ is a CPU exception, generated when software attempts to use an invalid **virtual address**</text><text fill="#FF0000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="69" x="10" y="219.4531">error42L</text><!--MD5=[5b4feefdb1bf84e01e05aa0435718ae1]
@startmindmap
++ Page Faults
+++ is a CPU exception, generated when software attempts to use an invalid **virtual address**
++++ the virtual address is **not mapped**
++++ the process has **insufficient permissions** for the address.
++++ the virtual address is valid, but **swapped out**. (This is software condition)
+++ The kernel handles page fault exceptions regularly as part of its memory management design
++++ TLB is often smaller than the total number of maps for a process
++++ Page faults at context switch time (例如进程切换)
++++ Lazy allocation
+++++ the kernel will not allocate pages requested by a process immediately
+++++ the kernel will wait until those pages are actually used.
+++++ this is a performance optimization
+++++ Process
++++++ When memory is requested, the kernel simply creates a record of the request in its **page tables** and the returns (quickly) to the process, without updating the TLB
++++++ When that newly-allocated memory is touched, the CPU will generate a page faultm because the CPU doesn't know about the mapping.
++++++ In the page fault handler, the kernel uses its page tables to determine that the mapping is valid(from the kernel's point of view) yet unmapped in the TLB.
++++++ The kernel will allocate a physical page frame and update the TLB with the new mapping.
++++++ The kernel returns from the exception handler and the user space program can resume.
+++++ the user space program **never is aware** that the page fault is happened
+++++ For processes that are time-sensitive, pages can be **pre-faulted**, ot simply touched, at the start of exexcution. ( **mlock() and mlockall()** )
+++++ See mm/mmap.c for do_brk()
++++++ do_brk() is implemented similar to mmap
+++++++ Modify the page tables for the new area
+++++++ Wait for the page fault
+++++++ Optionally, do_brk() can pre-fault the new area and allocate it. See mlock(2) to control this behavior
@endmindmap

PlantUML version 1.2022.4beta2(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>